name: Build and deploy Python app to Azure Web App - app-002-gen10-step3-1-py-oshima45

on:

push:

branches:

- master

workflow_dispatch:

jobs:

build:

runs-on: ubuntu-latest

permissions:

contents: read # actions/checkout のために必要

steps:

# コード取得

- uses: actions/checkout@v4

# Python セットアップ

- name: Set up Python

uses: actions/setup-python@v5

with:

python-version: '3.12'

# 依存関係のインストール

- name: Install dependencies

run: |

python -m pip install --upgrade pip

pip install -r requirements.txt

# デプロイ用アーティファクト作成

- name: Upload artifact for deployment

uses: actions/upload-artifact@v4

with:

name: python-app

path: |

.

!venv/ # 仮想環境は含めない

deploy:

runs-on: ubuntu-latest

needs: build

steps:

# アーティファクト取得

- name: Download artifact from build job

uses: actions/download-artifact@v4

with:

name: python-app

# Azure App Service へデプロイ

- name: Deploy to Azure Web App

uses: azure/webapps-deploy@v3

with:

app-name: 'app-002-gen10-step3-1-py-oshima45'

slot-name: 'Production'

publish-profile: ${{ secrets.AZUREAPPSERVICE_PUBLISHPROFILE_4E423786830542729B22F750280C8F81 }}
